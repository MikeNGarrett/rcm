var Jarvis=function(e,t){"use strict";var i,a;a={createElement:function(e,t,i){var a=document.createElement(e);if(t)for(var n in t)a.setAttribute(n,t[n]);if(i)a.innerHTML=i;return a},inputInFocus:function(e){return/INPUT|SELECT|TEXTAREA/.test(e.target.tagName)||e.target.contentEditable==="true"},trim:function(e){return String.prototype.trim?e.trim():e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}};i=function(e){var i=this;i.settings={hotkey:191,separator:"Â»"};t.extend(i.settings,e);i.localData=[];i.modal=a.createElement("div",{id:"jarvis-modal"});i.search=a.createElement("input",{type:"search",id:"jarvis-search"});i.overlay=a.createElement("div",{id:"jarvis-overlay"});t(i.overlay).on("click",function(e){i.close(e)});i.icons={};if(/complete|loaded/.test(document.readyState)){i.init()}else{t(function(e){i.init.call(i,e)})}};i.prototype={close:function(e){this.opened=false;this.overlay.parentNode.removeChild(this.overlay);this.modal.parentNode.removeChild(this.modal);t(this.search).typeahead("destroy")},init:function(){var i=this,n,s,r,o,c;t("#adminmenu a").each(function(e,n){var s,r,o,c,l,d;l=function(e){return t(e).clone().find("span").remove().end().text()};r=t(this).parents(".wp-has-submenu");s=l(r.find("a > .wp-menu-name"));o=l(this);d=function(){var e=r.find(".wp-menu-image"),t=r.find(".wp-menu-image img");if(t.length>0){return"background-image:url("+t.first().attr("src")+");background-position:center"}else if(e){return"background-image:"+e.css("background-image")+";background-position:"+e.css("background-position")}else{return null}}();i.icons[s.toLowerCase()]=d;switch(true){case s==="":case s===o:c=o;break;default:c=s+" "+i.settings.separator+" "+o}i.localData.push({icon:d,id:this.id||null,kind:"href",href:this.href,prefix:a.trim(s).toLowerCase(),title:a.trim(c),type:"menu"})});c={appearance:"nav_menu_item",attachment:"media",category:"posts",page:"pages",post:"posts",post_tag:"posts",post_format:"posts",term:"posts"};for(var l in c){if(c.hasOwnProperty){i.icons[l]=i.icons[c[l]]}}if(document.addEventListener){document.addEventListener("keydown",function(e){if(e.keyCode===i.settings.hotkey&&!a.inputInFocus(e)){e.preventDefault();e.stopPropagation()}},true)}t(document).on("keyup",function(){i.keystroke.apply(i,arguments)});t(e).on("resize",function(){i.resize.apply(i,arguments)})},keystroke:function(e){e.preventDefault();e.stopPropagation();switch(true){case this.opened&&e.keyCode===27:this.close();break;case a.inputInFocus(e):return;case!this.opened&&e.keyCode===this.settings.hotkey:this.open();break}},go:function(e,t,i){location.href=t.href},open:function(e){var i=this;if(e&&e.preventDefault)e.preventDefault();this.opened=true;this.modal.appendChild(this.search);document.body.appendChild(this.overlay);document.body.appendChild(this.modal);this.modal.style.marginLeft=Math.max(-1*this.modal.offsetWidth/2)+"px";t(this.search).typeahead([{engine:Hogan,name:"local",limit:5,local:i.localData,template:['<div class="{{prefix}} {{kind}}">','<div class="jarvis-icon" style="{{icon}}" title="{{prefix}}"></div>','<div class="jarvis-title">{{title}}</div>',"</div>"].join(""),valueKey:"title"},{engine:Hogan,name:"remote",limit:20,remote:{cache:false,dataType:"json",filter:function(e){for(var t=0;t<e.length;t++)e[t].icon=i.icons[e[t].type];return e},maxParallelRequests:10,url:ajaxurl+"?action=jarvis-search&q=%QUERY"},template:['<div class="{{type}} {{kind}}">','<div class="jarvis-icon" style="{{icon}}" title="{{type}}"></div>','<div class="jarvis-title" title="{{title}}">{{title}}</div>','{{#att_src}}<div class="jarvis-thumbnail"><img src="{{att_src}}"></div>{{/att_src}}',"</div>"].join(""),valueKey:"title"}]).on("typeahead:selected",function(){i.go.apply(i,arguments)});this.search.value="";this.search.focus()},resize:function(){this.modal.style.marginLeft=Math.max(-1*this.modal.offsetWidth/2)+"px"}};return i}(this,jQuery);